<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Vi1d&lt;3 — Demo Logger</title>
<style>
  :root{
    --bg:#0e0a12; --card:#1a1420; --txt:#fff; --muted:#c9b9c9;
    --pink:#ff4da6; --pink2:#ff8bd4;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--txt); background: radial-gradient(1200px 900px at 20% 0%, #241428 0, #120d17 45%, var(--bg) 70%);
    font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
    display:grid; place-items:center; overflow:hidden;
  }
  .bg{
    position:fixed; inset:0; pointer-events:none; filter:blur(30px) saturate(130%);
    background:
      radial-gradient(closest-side at 35% 30%, rgba(255,77,166,.45), transparent 60%),
      radial-gradient(closest-side at 65% 60%, rgba(255,139,212,.35), transparent 60%),
      conic-gradient(from 180deg at 50% 50%, rgba(255,77,166,.2), rgba(255,139,212,.2), rgba(255,77,166,.2));
    mix-blend-mode:screen; animation:pulse 7s ease-in-out infinite;
  }
  @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.04)}}
  .card{
    width:min(820px,92vw); background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
    border:1px solid rgba(255,255,255,.12); border-radius:22px; padding:24px;
    box-shadow:0 20px 60px rgba(0,0,0,.5), inset 0 1px 0 rgba(255,255,255,.06);
    position:relative; backdrop-filter: blur(8px);
  }
  .brand{display:flex; align-items:center; gap:14px; margin-bottom:8px}
  .logo{
    width:48px;height:48px;border-radius:14px; position:relative; transform:rotate(-6deg);
    background:
      radial-gradient(circle at 32% 35%, #ff6fb5 0 34%, transparent 35%),
      radial-gradient(circle at 68% 35%, #ff6fb5 0 34%, transparent 35%),
      radial-gradient(60% 60% at 50% 66%, #ff2d6f 0 46%, transparent 47%);
    box-shadow:0 8px 24px rgba(255,77,166,.35), inset 0 0 0 2px rgba(255,255,255,.14);
  }
  h1{
    margin:0; font-size:clamp(28px,6vw,46px); font-weight:900; letter-spacing:.3px;
    background:linear-gradient(90deg,var(--pink),var(--pink2)); -webkit-background-clip:text; background-clip:text; color:transparent;
    text-shadow:0 8px 22px rgba(255,77,166,.28);
  }
  .sub{color:var(--muted); margin:6px 0 16px}
  .consent{
    background:#18111f; border:1px dashed rgba(255,255,255,.22); border-radius:14px; padding:12px 14px; margin-bottom:14px;
  }
  .grid{display:grid; grid-template-columns:1fr 1fr; gap:14px}
  .panel{background:#120d17;border:1px solid rgba(255,255,255,.1); border-radius:14px; padding:12px}
  .panel h3{margin:0 0 8px; font-size:13px; letter-spacing:.3px; text-transform:uppercase; color:var(--muted)}
  .kv{display:grid; grid-template-columns:160px 1fr; gap:8px 10px; font-family:ui-monospace,Consolas,Menlo,monospace; font-size:13.2px}
  .kv div{padding:6px 8px; background:#0f0a14; border:1px solid rgba(255,255,255,.08); border-radius:10px; overflow:auto; white-space:nowrap}
  .btns{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
  button{
    border:0; padding:10px 14px; border-radius:12px; cursor:pointer; font-weight:800;
    background:linear-gradient(180deg,#2a1f2f,#1a1320); color:var(--txt);
    box-shadow:0 8px 20px rgba(0,0,0,.25), inset 0 1px 0 rgba(255,255,255,.05);
    transition:transform .12s ease, box-shadow .2s ease;
  }
  button:hover{transform:translateY(-1px)}
  .primary{background:linear-gradient(90deg,var(--pink),var(--pink2)); color:#1a1020; text-shadow:none}
  .foot{margin-top:12px; font-size:12.5px; color:var(--muted)}
  @media (max-width:720px){.grid{grid-template-columns:1fr}.kv{grid-template-columns:1fr}}
</style>
</head>
<body>
<div class="bg" aria-hidden="true"></div>
<main class="card" role="main">
  <div class="brand">
    <div class="logo" aria-hidden="true"></div>
    <div>
      <h1>Vi1d&lt;3</h1>
      <div class="sub">Kurze Demo: Welche Basisdaten sendet dein Browser? (mit opt-in)</div>
    </div>
  </div>

  <div class="consent">
    ⚠️ <b>Einwilligung:</b> Mit Klick auf „Senden“ werden deine IP (von ipify) & Basis-Browserdaten an einen Discord-Webhook gesendet.
    Nur zu Demonstrationszwecken.
    <div class="btns">
      <button class="primary" id="sendBtn">Senden an Discord</button>
      <button id="showBtn">Nur lokal anzeigen</button>
    </div>
  </div>

  <div class="grid">
    <section class="panel">
      <h3>Client-Daten</h3>
      <div id="clientKv" class="kv"><div>Warte…</div></div>
    </section>
    <section class="panel">
      <h3>Status</h3>
      <div id="statusKv" class="kv"><div>Status</div><div>Noch nichts gesendet</div></div>
    </section>
  </div>

  <div class="foot">Tipp: Nutze sowas niemals ohne Zustimmung. Erklären & aufklären, nicht heimlich tracken.</div>
</main>

<!-- unsichtbares Ziel für Cross-Origin Form-POST -->
<iframe name="sink" style="display:none"></iframe>

<script>
const WEBHOOK_URL = "https://discord.com/api/webhooks/1406003285600501970/DHV4856DEk1Um6N70WyTjnl5qMsPd1egU98METNMoC8Jgs1Dzgb2VCbqKtaaTigA_i1P";

const clientKv = document.getElementById('clientKv');
const statusKv = document.getElementById('statusKv');
const sendBtn  = document.getElementById('sendBtn');
const showBtn  = document.getElementById('showBtn');

function setKV(container, data){
  container.innerHTML = '';
  const keys = Object.keys(data);
  if(!keys.length){ container.innerHTML = '<div>Keine Daten</div>'; return; }
  for(const k of keys){
    const kEl = document.createElement('div'); kEl.textContent = k;
    const vEl = document.createElement('div'); vEl.textContent = String(data[k]);
    container.appendChild(kEl); container.appendChild(vEl);
  }
}

async function getPublicIP(){
  try{
    const r = await fetch('https://api.ipify.org?format=json',{cache:'no-store'});
    const j = await r.json();
    return j.ip || null;
  }catch(e){ return null; }
}

function collectClient(ip){
  const tz  = Intl.DateTimeFormat().resolvedOptions().timeZone;
  const lang= navigator.language || (navigator.languages && navigator.languages[0]);
  const scr = `${screen.width}×${screen.height} @${window.devicePixelRatio}x`;
  return {
    ip_public: ip,
    user_agent: navigator.userAgent,
    language: lang,
    timezone: tz,
    screen: scr,
    referrer: document.referrer || null,
    url: location.href,
    timestamp_iso: new Date().toISOString()
  };
}

function msgFromData(d){
  return [
    "**Vi1d<3 Demo — Browserdaten**",
    "```",
    `IP:          ${d.ip_public || "n/a"}`,
    `UA:          ${d.user_agent}`,
    `Lang:        ${d.language}`,
    `Timezone:    ${d.timezone}`,
    `Screen:      ${d.screen}`,
    `Referrer:    ${d.referrer || "none"}`,
    `URL:         ${d.url}`,
    `Timestamp:   ${d.timestamp_iso}`,
    "```"
  ].join("\n");
}

// POST ohne CORS via HTML-Form (wird in unsichtbarem <iframe> gesendet)
function postToDiscord(content){
  const form = document.createElement('form');
  form.method = 'POST';
  form.action = WEBHOOK_URL;
  form.enctype = 'application/x-www-form-urlencoded';
  form.target = 'sink'; // verhindert Navigation der Seite

  const p1 = document.createElement('input');
  p1.type = 'hidden'; p1.name = 'content'; p1.value = content;

  const p2 = document.createElement('input');
  p2.type = 'hidden'; p2.name = 'username'; p2.value = 'Vi1d<3 Demo';

  form.appendChild(p1); form.appendChild(p2);
  document.body.appendChild(form);
  form.submit();
  setTimeout(()=> form.remove(), 1000);
}

function setStatus(k, v){
  const cur = {};
  // read back current kv to preserve others
  statusKv.querySelectorAll(':scope > div').forEach((el,i)=>{
    // pairs of two
  });
  setKV(statusKv, {[k]: v});
}

// Init: sofort IP holen & anzeigen
(async ()=>{
  const ip = await getPublicIP();
  const data = collectClient(ip);
  setKV(clientKv, data);

  showBtn.onclick = ()=> alert(msgFromData(data));

  sendBtn.onclick = ()=>{
    sendBtn.disabled = true;
    const text = msgFromData(data);
    try{
      postToDiscord(text);
      setKV(statusKv, { Status: 'Gesendet (falls der Webhook aktiv ist). Antwort wird nicht angezeigt (Cross-Origin).' });
    }catch(e){
      setKV(statusKv, { Fehler: 'Konnte nicht senden.' });
    }finally{
      setTimeout(()=> sendBtn.disabled = false, 1500);
    }
  };
})();
</script>
</body>
</html>
